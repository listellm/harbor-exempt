<tr id="vuln-row-{{ child.id }}" class="child-row" data-parent-group="{{ group_id }}" style="display: none;">
    <td style="padding-left: 2rem;">
        <span class="text-muted mono" style="font-size: 0.8125rem;">&#8627; {{ child.repository }}</span>
    </td>
    <td></td>
    <td></td>
    <td>
        <span class="status-badge status-{{ child.status }}">{{ child.status }}</span>
    </td>
    <td class="text-muted" style="font-size: 0.8125rem;">{{ child.installed_version or '—' }}</td>
    <td style="font-size: 0.8125rem;">
        {%- set has_trivy = child.fixed_version and child.fixed_version != '' -%}
        {%- set has_osv = child.has_fix and not has_trivy -%}
        {%- if has_trivy -%}
        <span class="fix-available" title="Fix available (Trivy)"><svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z"/></svg>{{ child.fixed_version }}</span>
        {%- elif has_osv -%}
        <span class="fix-available" title="Fix available (OSV)"><svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z"/></svg>OSV</span>
        {%- else -%}
        <span class="text-muted">—</span>
        {%- endif -%}
    </td>
    <td class="text-muted" style="font-size: 0.8125rem;">{{ child.first_seen_at|format_datetime }}</td>
    <td class="text-muted" style="font-size: 0.8125rem;">{{ child.last_seen_at|format_datetime }}</td>
    <td>
        {% if is_admin %}
            {% if child.status == 'open' %}
            <button class="btn btn-sm btn-primary"
                    hx-get="/partials/accept-form/{{ child.id }}?project_name={{ project_name }}"
                    hx-target="#vuln-row-{{ child.id }}"
                    hx-swap="afterend">Accept</button>
            {% elif child.status == 'accepted' and child.acceptance %}
            <button class="btn btn-sm btn-danger"
                    hx-post="/ui/revoke"
                    hx-vals='{"acceptance_id": "{{ child.acceptance.id }}", "vulnerability_id": "{{ child.id }}", "project_name": "{{ project_name }}"}'
                    hx-target="#vuln-row-{{ child.id }}"
                    hx-swap="outerHTML"
                    hx-confirm="Revoke acceptance for {{ child.cve_id }}?">Revoke</button>
            {% endif %}
        {% endif %}
    </td>
</tr>
