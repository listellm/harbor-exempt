<tbody id="vuln-table-body">
    {% for vuln in vulnerabilities %}
    {% include "partials/vuln_row.html" %}
    {% set children = vuln.get('_children', []) %}
    {% set group_id = vuln.get('_group_id', '') %}
    {% if children %}
    {% for child in children %}
    {% include "partials/vuln_child_row.html" %}
    {% endfor %}
    {% endif %}
    {% endfor %}
    {% if not vulnerabilities %}
    <tr>
        <td colspan="9" class="empty-state" style="padding: 2rem;">
            No vulnerabilities match the current filters.
        </td>
    </tr>
    {% endif %}
</tbody>

{% set partial_base = partial_url|default("/partials/projects/" + project_name + "/vulnerabilities") %}
{% if total > 0 %}
<tfoot>
    <tr>
        <td colspan="9">
            <div class="pagination">
                <span class="pagination-info">
                    Showing {{ ((page - 1) * per_page) + 1 }}â€“{{ [page * per_page, total]|min }} of {{ total }}
                </span>
                <div class="pagination-buttons">
                    {% if page > 1 %}
                    <button class="btn btn-sm"
                            hx-get="{{ partial_base }}?page={{ page - 1 }}&per_page={{ per_page }}{% for st in status %}&status={{ st }}{% endfor %}{% for s in severity %}&severity={{ s }}{% endfor %}"
                            hx-target="#vuln-table-body"
                            hx-swap="outerHTML"
                            hx-select="tbody">Previous</button>
                    {% endif %}
                    {% if page * per_page < total %}
                    <button class="btn btn-sm"
                            hx-get="{{ partial_base }}?page={{ page + 1 }}&per_page={{ per_page }}{% for st in status %}&status={{ st }}{% endfor %}{% for s in severity %}&severity={{ s }}{% endfor %}"
                            hx-target="#vuln-table-body"
                            hx-swap="outerHTML"
                            hx-select="tbody">Next</button>
                    {% endif %}
                </div>
            </div>
        </td>
    </tr>
</tfoot>
{% endif %}
